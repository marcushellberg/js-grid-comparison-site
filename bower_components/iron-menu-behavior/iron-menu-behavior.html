<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="../iron-selector/iron-multi-selectable.html"><link rel="import" href="../iron-a11y-keys-behavior/iron-a11y-keys-behavior.html"><script>Polymer.IronMenuBehaviorImpl={properties:{focusedItem:{observer:'_focusedItemChanged',readOnly:!0,type:Object},attrForItemTitle:{type:String},disabled:{type:Boolean,value:!1,observer:'_disabledChanged'}},_SEARCH_RESET_TIMEOUT_MS:1e3,_previousTabIndex:0,hostAttributes:{role:'menu'},observers:['_updateMultiselectable(multi)'],listeners:{focus:'_onFocus',keydown:'_onKeydown','iron-items-changed':'_onIronItemsChanged'},keyBindings:{up:'_onUpKey',down:'_onDownKey',esc:'_onEscKey','shift+tab:keydown':'_onShiftTabDown'},attached:function(){this._resetTabindices()},select:function(b){this._defaultFocusAsync&&(this.cancelAsync(this._defaultFocusAsync),this._defaultFocusAsync=null);var c=this._valueToItem(b);c&&c.hasAttribute('disabled')||(this._setFocusedItem(c),Polymer.IronMultiSelectableBehaviorImpl.select.apply(this,arguments))},_resetTabindices:function(){var b=this.multi?this.selectedItems&&this.selectedItems[0]:this.selectedItem;this.items.forEach(function(c){c.setAttribute('tabindex',c===b?'0':'-1')},this)},_updateMultiselectable:function(b){b?this.setAttribute('aria-multiselectable','true'):this.removeAttribute('aria-multiselectable')},_focusWithKeyboardEvent:function(b){this.cancelDebouncer('_clearSearchText');var c=this._searchText||'',d=b.key&&1==b.key.length?b.key:String.fromCharCode(b.keyCode);c+=d.toLocaleLowerCase();for(var g,e=c.length,f=0;g=this.items[f];f++)if(!g.hasAttribute('disabled')){var h=this.attrForItemTitle||'textContent',j=(g[h]||g.getAttribute(h)||'').trim();if(!(j.length<e)&&j.slice(0,e).toLocaleLowerCase()==c){this._setFocusedItem(g);break}}this._searchText=c,this.debounce('_clearSearchText',this._clearSearchText,this._SEARCH_RESET_TIMEOUT_MS)},_clearSearchText:function(){this._searchText=''},_focusPrevious:function(){for(var e,b=this.items.length,c=+this.indexOf(this.focusedItem),d=1;d<b+1;d++)if(e=this.items[(c-d+b)%b],!e.hasAttribute('disabled')){var f=Polymer.dom(e).getOwnerRoot()||document;if(this._setFocusedItem(e),Polymer.dom(f).activeElement==e)return}},_focusNext:function(){for(var e,b=this.items.length,c=+this.indexOf(this.focusedItem),d=1;d<b+1;d++)if(e=this.items[(c+d)%b],!e.hasAttribute('disabled')){var f=Polymer.dom(e).getOwnerRoot()||document;if(this._setFocusedItem(e),Polymer.dom(f).activeElement==e)return}},_applySelection:function(b,c){c?b.setAttribute('aria-selected','true'):b.removeAttribute('aria-selected'),Polymer.IronSelectableBehavior._applySelection.apply(this,arguments)},_focusedItemChanged:function(b,c){c&&c.setAttribute('tabindex','-1'),!b||b.hasAttribute('disabled')||this.disabled||(b.setAttribute('tabindex','0'),b.focus())},_onIronItemsChanged:function(b){b.detail.addedNodes.length&&this._resetTabindices()},_onShiftTabDown:function(){var c=this.getAttribute('tabindex');Polymer.IronMenuBehaviorImpl._shiftTabPressed=!0,this._setFocusedItem(null),this.setAttribute('tabindex','-1'),this.async(function(){this.setAttribute('tabindex',c),Polymer.IronMenuBehaviorImpl._shiftTabPressed=!1},1)},_onFocus:function(b){if(!Polymer.IronMenuBehaviorImpl._shiftTabPressed){var c=Polymer.dom(b).rootTarget;(c===this||'undefined'==typeof c.tabIndex||this.isLightDescendant(c))&&(this._defaultFocusAsync=this.async(function(){var d=this.multi?this.selectedItems&&this.selectedItems[0]:this.selectedItem;this._setFocusedItem(null),d?this._setFocusedItem(d):this.items[0]&&this._focusNext()}))}},_onUpKey:function(b){this._focusPrevious(),b.detail.keyboardEvent.preventDefault()},_onDownKey:function(b){this._focusNext(),b.detail.keyboardEvent.preventDefault()},_onEscKey:function(){this.focusedItem.blur()},_onKeydown:function(b){this.keyboardEventMatchesKeys(b,'up down esc')||this._focusWithKeyboardEvent(b),b.stopPropagation()},_activateHandler:function(b){Polymer.IronSelectableBehavior._activateHandler.call(this,b),b.stopPropagation()},_disabledChanged:function(b){b?(this._previousTabIndex=this.hasAttribute('tabindex')?this.tabIndex:0,this.removeAttribute('tabindex')):!this.hasAttribute('tabindex')&&this.setAttribute('tabindex',this._previousTabIndex)}},Polymer.IronMenuBehaviorImpl._shiftTabPressed=!1,Polymer.IronMenuBehavior=[Polymer.IronMultiSelectableBehavior,Polymer.IronA11yKeysBehavior,Polymer.IronMenuBehaviorImpl];</script></head><body></body></html>