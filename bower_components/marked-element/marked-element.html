<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="marked-import.html"></head><body><dom-module id="marked-element"><template><style>:host{display:block;}.hidden{display:none !important;}</style><content select=".markdown-html"></content><div id="content" class="hidden"></div></template></dom-module><script>'use strict';Polymer({is:'marked-element',properties:{markdown:{observer:'render',type:String,value:null},breaks:{observer:'render',type:Boolean,value:!1},pedantic:{observer:'render',type:Boolean,value:!1},renderer:{observer:'render',type:Function,value:null},sanitize:{observer:'render',type:Boolean,value:!1},smartypants:{observer:'render',type:Boolean,value:!1},callback:{observer:'render',type:Function,value:null},xhr:{type:Object,notify:!0,readOnly:!0}},ready:function(){if(!this.markdown){var b=Polymer.dom(this).querySelector('[type="text/markdown"]');b&&(this.markdown=this._unindent(b.textContent),b.src&&this._request(b.src))}},attached:function(){this._attached=!0,this._outputElement=this.outputElement,this.render()},detached:function(){this._attached=!1},unindent:function(b){return this._unindent(b)},get outputElement(){var a=Polymer.dom(this).queryDistributedElements('.markdown-html')[0];return a?a:(this.toggleClass('hidden',!1,this.$.content),this.$.content)},render:function(){if(this._attached){if(!this.markdown)return void(Polymer.dom(this._outputElement).innerHTML='');var b=new marked.Renderer;this.renderer&&this.renderer(b);var c={renderer:b,highlight:this._highlight.bind(this),breaks:this.breaks,sanitize:this.sanitize,pedantic:this.pedantic,smartypants:this.smartypants};Polymer.dom(this._outputElement).innerHTML=marked(this.markdown,c,this.callback),this.fire('marked-render-complete')}},_highlight:function(b,c){var d=this.fire('syntax-highlight',{code:b,lang:c});return d.detail.code||b},_unindent:function(b){if(!b)return b;var c=b.replace(/\t/g,'  ').split('\n'),d=c.reduce(function(f,g){if(/^\s*$/.test(g))return f;var h=g.match(/^(\s*)/)[0].length;return null===f?h:h<f?h:f},null);return c.map(function(f){return f.substr(d)}).join('\n')},_request:function(b){this._setXhr(new XMLHttpRequest);var c=this.xhr;return 0<c.readyState?null:void(c.addEventListener('error',this._handleError.bind(this)),c.addEventListener('loadend',function(d){var f=this.xhr.status||0;0===f||200<=f&&300>f?this.markdown=d.target.response:this._handleError(d)}.bind(this)),c.open('GET',b),c.setRequestHeader('Accept','text/markdown'),c.send())},_handleError:function(b){var c=this.fire('marked-request-error',b,{cancelable:!0});c.defaultPrevented||(this.markdown='Failed loading markdown source')}});</script></body></html>